<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${fragment.label}</title>
    <link rel="stylesheet" href="./materialize/materialize.css">
    <link href="./materialize/googleicons.css" rel="stylesheet">
    <script src="./materialize/materialize.js"></script>
    <style>
        .vscode-dark input {
            width: 100%;
            color: white;
            font-size: 15px;
            border: none
        }

        .vscode-dark textarea {
            width: 100%;
            color: white;
            font-size: 15px;
            height: auto;
            resize: none;
        }

        .vscode-light input {
            width: 100%;
            color: black;
            font-size: 15px;
            border: none
        }

        .vscode-light textarea {
            width: 100%;
            color: black;
            font-size: 15px;
            height: auto;
            resize: none;
        }
    </style>
</head>

<body class="vscode-light">
    <h3 style="float: left; max-width: 70%; overflow: hidden;" id="label">${fragment.label}</h3>
    <button style="float: right; margin: 10px; margin-top: 35px" onclick="cancelFunction()"
        class="btn waves-effect waves-light" type="submit" name="action">Cancel</button>
    <button style="float: right; margin: 10px; margin-top: 35px" onclick="submitFunction()"
        class="btn waves-effect waves-light" type="submit" name="action">Save</button>
    <br><br><br><br><br>
    Description: <input id="description" type="text" value="${fragment.description}">
    Keywords: <input id="keywords" type="text" value="${fragment.keywords}">
    Tags: <div class="chips chips-autocomplete"></div>
    Prefix: <input id="prefix" type="text" value="${fragment.prefix}">
    Body: <textarea id="body" rows="16">${fragment.body}</textarea>
    <button title="Replaces Keywords, Body and Placeholders" style="float: right; margin: 10px; margin-top: 5px"
        onclick="parametrize()" class="btn waves-effect waves-light" type="submit" name="action">Parametrize</button>
    <br><br><br>
    Scope: <input id="scope" type="text" value="${fragment.scope}">
    Domain: <input id="domain" type="text" value="${fragment.domain}">
    Placeholders: <input style="color:lightgrey;" id="placeholders" type="text" value="${fragment.placeholders}"
        disabled>

    <script>
        var tags;
        //const vscode = acquireVsCodeApi();
        function submitFunction() {
            console.log({
                command: 'submit', text: {
                    "label": document.getElementById("label").innerHTML,
                    "description": document.getElementById("description").value,
                    "keywords": document.getElementById("keywords").value,
                    "tags": tags[0].chipsData.map(chip => chip.tag).join(),
                    "prefix": document.getElementById("prefix").value,
                    "body": document.getElementById("body").value,
                    "scope": document.getElementById("scope").value,
                    "domain": document.getElementById("domain").value,
                    "placeholders": document.getElementById("placeholders").value
                }
            });
        }

        function cancelFunction() {
            console.log({ command: 'cancel', text: '' });
        }

        function parametrize() {
            console.log({ command: 'parametrize', text: document.getElementById("body").value });
        }

        window.addEventListener('message', event => {
            const message = event.data;
            switch (message.command) {
                case 'parametrize':
                    document.getElementById("body").value = message.text.body;
                    document.getElementById("keywords").value = message.text.keywords;
                    document.getElementById("placeholders").value = message.text.placeholders;
                    return;
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            var elems = document.querySelectorAll('.chips');
            tags = M.Chips.init(elems, {
                data: [
                    { tag: "a" },
                    { tag: "b" },
                ],
                autocompleteOptions: {
                    data: {
                        'abc': null,
                        'def': null,
                        'ghi': null
                    },
                    limit: Infinity,
                    minLength: 1
                }
            });
        });
    </script>

</body>

</html>`